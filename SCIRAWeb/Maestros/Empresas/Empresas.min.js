function inicializarVentana(){$.ajax({type:"GET",url:gsUrlApi+"/paises",headers:gsAutenticacion,contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){if(n.Error){mostrarAlertas(n.Mensaje,"error");return}crearComboBuscador("select_Pais",n.paises,"Seleccionar país");$("#select_Pais").on("select2:select",consultarMunicipios);$("#select_Pais").val("169").trigger("change");consultarMunicipios()},error:function(){mostrarAlertas("Error en ajax al cargar paises.","error")}});crearComboBuscador("select_TipoIdentificacion",null,"Seleccionar tipo identificación");consultarEmpresa();$("#select_TipoIdentificacion").on("change",function(){if($("#select_TipoIdentificacion").val()==="31"){var n=calcularDigitoVerificacion($("#input_Identificacion").val());$("#label_DigitoVerificacion").text(n)}else $("#label_DigitoVerificacion").text("-")});$("#input_Identificacion").on("change",function(){if($("#select_TipoIdentificacion").val()==="31"){var n=calcularDigitoVerificacion($("#input_Identificacion").val());$("#label_DigitoVerificacion").text(n)}else $("#label_DigitoVerificacion").text("-")});window.File&&window.FileReader&&window.FileList&&window.Blob?document.getElementById("input_FileImagen").addEventListener("change",handleFileSelect,!1):mostrarAlertas("No es posible subir imagenes usando este navegador web.","error");parent.habilitarBotones(!0,"|G|");var n=document.querySelector(".js-switch"),t=new Switchery(n,{color:"#1AB394"});marcarCamposRequeridos("#div_Formulario")}function consultarEmpresa(){var n=obtenerQueryString("IdEmpresa");$.ajax({type:"GET",url:gsUrlApi+"/empresas/IdEmpresa/"+n,headers:gsAutenticacion,contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){if(n.Error){mostrarAlertas(n.Mensaje,"error");return}cargarDataEmpresa(n.empresas[0])},error:function(){mostrarAlertas("Error en ajax al cargar empresas.","error")}})}function guardar(){var n={},u="",t,i,r;try{parent.habilitarBotones();ValidarCamposJson("#div_Formulario")?(n.IdTipoIdentificacion=$("#select_TipoIdentificacion").val(),n.TipoIdentificacion=$("#select_TipoIdentificacion").find("option:selected").text(),n.Identificacion=$("#input_Identificacion").val(),n.DigitoVerificacion=$("#label_DigitoVerificacion").text(),n.Nombre=$("#input_RazonSocial").val(),n.Direccion=$("#input_Direccion").val(),n.IdPais=$("#select_Pais").val(),n.Pais=$("#select_Pais").find("option:selected").text(),n.IdMunicipio=$("#select_Municipio").val(),n.Municipio=$("#select_Municipio").find("option:selected").text(),n.Telefono1=$("#input_Telefono1").val(),n.Telefono2=$("#input_Telefono2").val(),n.Celular=$("#input_Celular").val(),n.Correo=$("#input_Correo").val(),n.PaginaWeb=$("#input_PaginaWeb").val(),n.UsuarioActualizacion=obtenerQueryString("IdUsuario"),n.FechaActualizacion=new Date,n.IdEmpresa=obtenerQueryString("IdEmpresa"),n.Activo=document.getElementById("input_Activo").checked,t=document.getElementById("img_LogoImpresion"),t&&(n.LogoImpresion=t.src.split("base64,")[1]),i=document.getElementById("img_LogoInicioSesion"),i&&(n.LogoInicioSesion=i.src.split("base64,")[1]),r=document.getElementById("img_Logo"),r&&(n.Logo=r.src.split("base64,")[1]),u=JSON.stringify(n),$.ajax({type:"POST",url:gsUrlApi+"/empresas/actualizar",data:u,headers:gsAutenticacion,contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){if(n.empresas.Error){mostrarAlertas(n.empresas.Mensaje,"error");return}parent.habilitarBotones(!0,"|G|");mostrarAlertas(n.empresas.Mensaje,"success")},error:function(){mostrarAlertas("Error en ajax al gestionar el guardado de la empresa.","error")}})):parent.habilitarBotones(!0,"|G|")}catch(f){mostrarAlertas("Error al guardar:\n"+f.message,"error");parent.habilitarBotones(!0,"|G|")}}function cargarDataEmpresa(n){var t,i,r;try{$("#select_TipoIdentificacion").val(n.IdTipoIdentificacion).trigger("change");$("#input_Identificacion").val(n.Identificacion);$("#label_DigitoVerificacion").text(n.DigitoVerificacion);$("#input_RazonSocial").val(n.Nombre);$("#input_Direccion").val(n.Direccion);$("#input_Telefono1").val(n.Telefono1);$("#input_Telefono2").val(n.Telefono2);$("#input_Celular").val(n.Celular);$("#input_Correo").val(n.Correo);$("#input_PaginaWeb").val(n.PaginaWeb);$("#select_Pais").val(n.IdPais).trigger("change");gsIdMunicipio=n.IdMunicipio;consultarMunicipios();t=document.getElementById("img_Logo");t&&(t.src="data:image/jpeg;base64,"+n.Logo);i=document.getElementById("img_LogoImpresion");i&&(i.src="data:image/jpeg;base64,"+n.LogoImpresion);r=document.getElementById("img_LogoInicioSesion");r&&(r.src="data:image/jpeg;base64,"+n.LogoInicioSesion);document.getElementById("input_Activo")!==null&&(document.getElementById("input_Activo").checked&&!n.Activo?document.getElementById("input_Activo").click():!document.getElementById("input_Activo").checked&&n.Activo&&document.getElementById("input_Activo").click());$("#input_Celular").trigger("keyup")}catch(u){mostrarAlertas("Error al cargarDataEmpresa():\n"+u.message,"error")}}function consultarMunicipios(){var n=document.getElementById("select_Pais").value;if(!n){crearComboBuscador("select_Municipio",[],"Seleccionar municipio");$("#select_Municipio").prop("disabled",!0);return}$.ajax({type:"GET",url:gsUrlApi+"/municipios/IdPais/"+n,headers:gsAutenticacion,contentType:"application/json; charset=utf-8",dataType:"json",success:function(n){if(n.Error){mostrarAlertas(n.Mensaje,"error");return}var t=n.municipios;crearComboBuscador("select_Municipio",t,"Seleccionar municipio");t.length>0?($("#select_Municipio").prop("disabled",!1),gsIdMunicipio!==null&&$("#select_Municipio").val(gsIdMunicipio).trigger("change")):$("#select_Municipio").prop("disabled",!0)},error:function(){mostrarAlertas("Error en ajax en consultarMunicipios().","error")}})}var gsIdMunicipio=null,gObjEventoImagen=null;inicializarVentana();